!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).z={})}(this,(function(e){"use strict";var t=Object.defineProperty,n=(e,n,r)=>((e,n,r)=>n in e?t(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r)(e,"symbol"!=typeof n?n+"":n,r);function r(e,t){e.innerHTML="",e.appendChild(t())}function o(e="",t=6){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r="1234567890";let o=e;const i=Date.now(),a=n.charAt(Math.floor(26*Math.random())),s=r.charAt(Math.floor(10*Math.random()));if(!e)for(let l=0;l<t;l++)o+=n.charAt(Math.floor(26*Math.random()));return o+=`_${i}${a}${s}`,o}const i=/* @__PURE__ */new Map;let a;var s;var l="http://www.w3.org/1999/xhtml",c="undefined"==typeof document?void 0:document,d=!!c&&"content"in c.createElement("template"),u=!!c&&c.createRange&&"createContextualFragment"in c.createRange();function f(e){return e=e.trim(),d?function(e){var t=c.createElement("template");return t.innerHTML=e,t.content.childNodes[0]}(e):u?function(e){return s||(s=c.createRange()).selectNode(c.body),s.createContextualFragment(e).childNodes[0]}(e):function(e){var t=c.createElement("body");return t.innerHTML=e,t.childNodes[0]}(e)}function h(e,t){var n,r,o=e.nodeName,i=t.nodeName;return o===i||(n=o.charCodeAt(0),r=i.charCodeAt(0),n<=90&&r>=97?o===i.toUpperCase():r<=90&&n>=97&&i===o.toUpperCase())}function m(e,t,n){e[n]!==t[n]&&(e[n]=t[n],e[n]?e.setAttribute(n,""):e.removeAttribute(n))}var p={OPTION:function(e,t){var n=e.parentNode;if(n){var r=n.nodeName.toUpperCase();"OPTGROUP"===r&&(r=(n=n.parentNode)&&n.nodeName.toUpperCase()),"SELECT"!==r||n.hasAttribute("multiple")||(e.hasAttribute("selected")&&!t.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),n.selectedIndex=-1)}m(e,t,"selected")},INPUT:function(e,t){m(e,t,"checked"),m(e,t,"disabled"),e.value!==t.value&&(e.value=t.value),t.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,t){var n=t.value;e.value!==n&&(e.value=n);var r=e.firstChild;if(r){var o=r.nodeValue;if(o==n||!n&&o==e.placeholder)return;r.nodeValue=n}},SELECT:function(e,t){if(!t.hasAttribute("multiple")){for(var n,r,o=-1,i=0,a=e.firstChild;a;)if("OPTGROUP"===(r=a.nodeName&&a.nodeName.toUpperCase()))a=(n=a).firstChild;else{if("OPTION"===r){if(a.hasAttribute("selected")){o=i;break}i++}!(a=a.nextSibling)&&n&&(a=n.nextSibling,n=null)}e.selectedIndex=o}}};function b(){}function v(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}var g,y=(g=function(e,t){var n,r,o,i,a=t.attributes;if(11!==t.nodeType&&11!==e.nodeType){for(var s=a.length-1;s>=0;s--)r=(n=a[s]).name,o=n.namespaceURI,i=n.value,o?(r=n.localName||r,e.getAttributeNS(o,r)!==i&&("xmlns"===n.prefix&&(r=n.name),e.setAttributeNS(o,r,i))):e.getAttribute(r)!==i&&e.setAttribute(r,i);for(var l=e.attributes,c=l.length-1;c>=0;c--)r=(n=l[c]).name,(o=n.namespaceURI)?(r=n.localName||r,t.hasAttributeNS(o,r)||e.removeAttributeNS(o,r)):t.hasAttribute(r)||e.removeAttribute(r)}},function(e,t,n){if(n||(n={}),"string"==typeof t)if("#document"===e.nodeName||"HTML"===e.nodeName||"BODY"===e.nodeName){var r=t;(t=c.createElement("html")).innerHTML=r}else t=f(t);else 11===t.nodeType&&(t=t.firstElementChild);var o=n.getNodeKey||v,i=n.onBeforeNodeAdded||b,a=n.onNodeAdded||b,s=n.onBeforeElUpdated||b,d=n.onElUpdated||b,u=n.onBeforeNodeDiscarded||b,m=n.onNodeDiscarded||b,y=n.onBeforeElChildrenUpdated||b,E=n.skipFromChildren||b,C=n.addChild||function(e,t){return e.appendChild(t)},N=!0===n.childrenOnly,T=/* @__PURE__ */Object.create(null),A=[];function w(e){A.push(e)}function S(e,t){if(1===e.nodeType)for(var n=e.firstChild;n;){var r=void 0;t&&(r=o(n))?w(r):(m(n),n.firstChild&&S(n,t)),n=n.nextSibling}}function L(e,t,n){!1!==u(e)&&(t&&t.removeChild(e),m(e),S(e,n))}function M(e){a(e);for(var t=e.firstChild;t;){var n=t.nextSibling,r=o(t);if(r){var i=T[r];i&&h(t,i)?(t.parentNode.replaceChild(i,t),x(i,t)):M(t)}else M(t);t=n}}function x(e,t,n){var r=o(t);if(r&&delete T[r],!n){var a=s(e,t);if(!1===a)return;if(a instanceof HTMLElement&&(e=a),g(e,t),d(e),!1===y(e,t))return}"TEXTAREA"!==e.nodeName?function(e,t){var n,r,a,s,l,d=E(e,t),u=t.firstChild,f=e.firstChild;e:for(;u;){for(s=u.nextSibling,n=o(u);!d&&f;){if(a=f.nextSibling,u.isSameNode&&u.isSameNode(f)){u=s,f=a;continue e}r=o(f);var m=f.nodeType,b=void 0;if(m===u.nodeType&&(1===m?(n?n!==r&&((l=T[n])?a===l?b=!1:(e.insertBefore(l,f),r?w(r):L(f,e,!0),r=o(f=l)):b=!1):r&&(b=!1),(b=!1!==b&&h(f,u))&&x(f,u)):3!==m&&8!=m||(b=!0,f.nodeValue!==u.nodeValue&&(f.nodeValue=u.nodeValue))),b){u=s,f=a;continue e}r?w(r):L(f,e,!0),f=a}if(n&&(l=T[n])&&h(l,u))d||C(e,l),x(l,u);else{var v=i(u);!1!==v&&(v&&(u=v),u.actualize&&(u=u.actualize(e.ownerDocument||c)),C(e,u),M(u))}u=s,f=a}!function(e,t,n){for(;t;){var r=t.nextSibling;(n=o(t))?w(n):L(t,e,!0),t=r}}(e,f,r);var g=p[e.nodeName];g&&g(e,t)}(e,t):p.TEXTAREA(e,t)}!function e(t){if(1===t.nodeType||11===t.nodeType)for(var n=t.firstChild;n;){var r=o(n);r&&(T[r]=n),e(n),n=n.nextSibling}}(e);var _,O,P=e,U=P.nodeType,D=t.nodeType;if(!N)if(1===U)1===D?h(e,t)||(m(e),P=function(e,t){for(var n=e.firstChild;n;){var r=n.nextSibling;t.appendChild(n),n=r}return t}(e,(_=t.nodeName,(O=t.namespaceURI)&&O!==l?c.createElementNS(O,_):c.createElement(_)))):P=t;else if(3===U||8===U){if(D===U)return P.nodeValue!==t.nodeValue&&(P.nodeValue=t.nodeValue),P;P=t}if(P===t)m(e);else{if(t.isSameNode&&t.isSameNode(P))return;if(x(P,t,N),A)for(var k=0,H=A.length;k<H;k++){var R=T[A[k]];R&&L(R,R.parentNode,!1)}}return!N&&P!==e&&e.parentNode&&(P.actualize&&(P=P.actualize(e.ownerDocument||c)),e.parentNode.replaceChild(P,e)),P});const E=/* @__PURE__ */new Set;function C(e,t,n){const r=e.tagName.toLowerCase(),o=function(e,t,n){const r={};return Array.from(e.attributes).forEach((e=>{const o=e.value.trim(),i=t.find((e=>e.name===o));if(i)r[e.name]=i.fn;else{const t=n.find((e=>e.name===o));r[e.name]=t?t.name:e.value}})),r}(e,t,n);return{type:r,content:Array.from(e.childNodes).filter((e=>e.nodeType===Node.TEXT_NODE)).map((e=>e.textContent.trim())).join(""),attributes:o,children:Array.from(e.childNodes).filter((e=>e.nodeType===Node.ELEMENT_NODE)).map((e=>C(e,t,n))),elements:n}}function N(e,t){const{type:n,content:r,attributes:i,children:a,elements:s}=e,l=document.createElement(n);if(!l.hasAttribute("_id")){const e=o("ELEMENT");l.setAttribute("_id",e),t&&t.size>0&&t.forEach((t=>t.elementInDom=e))}r&&(l.textContent=r);for(const[o,c]of Object.entries(i))if(o.startsWith("on")){const e=o.slice(2).toLowerCase();"change"===e?l.addEventListener("input",c):l.addEventListener(e,c)}else l.setAttribute(o,c);return a&&a.forEach((e=>{const t=N(e);l.appendChild(t)})),Array.from(l.querySelectorAll("div[_id]")).forEach((e=>{const t=e.getAttribute("_id"),n=s.find((e=>e.name===t));n&&e.replaceWith(n.element)})),l}const{channels:T}=new function(e={}){let t=[],n=e.plugins||[],r={};n.length>0&&n.forEach((e=>{const t=e.name||"UnNamedPlugin";r[t]=e}));const o=e=>t[e].state,i=(e,n)=>{const r=t[e];let o=r.state;for(const t of r.activePlugins)if(t.getter){const e=t.getter.method(o,t.getter.options);o={...o,...e}}return((e,n)=>{((null==n?void 0:n.auto)??1)&&a(e,(()=>t[e].state));return t[e].state})(e,n)},a=(e,n)=>{t[e].subscribers.add(n)},s=e=>{t[e].subscribers.forEach((n=>n(t[e].state)))},l=(e,t)=>{let n=o(e),r=t;return"function"==typeof t&&(r=t(n)),c(e,r)},c=(e,n)=>{let r=t[e].state;return t[e].state=n,t[e].history.length<=10||(t[e].history=[]),t[e].history.push(r),s(e),t[e].state},d=async(e,n)=>{const r=t[e],i=u(r.middleWares,e);let a=o(e),s=n;"function"==typeof n&&(s=n(a));try{const t=await i(s);return c(e,t)}catch(l){}},u=(e,t)=>e.reduce(((e,t,n)=>async(n,...r)=>{try{const o=await e(n,...r);return await t(o,...r)}catch(o){throw o}}));return{channels:{getChannels:()=>t,getChannel:e=>t[e]?t[e]:null,addChannel:(e,n={})=>(t[e]={name:e,activePlugins:[],subscribers:/* @__PURE__ */new Set,state:n,middleWares:[],history:[],setState:n=>((e,n)=>{const r=t[e];let i=o(e),a=n;"function"==typeof n&&(a=n(i));for(const t of r.activePlugins)t.setter&&(a=t.setter.method(a,t.setter.options));return l(e,a)})(e,n),setStateAsync:t=>d(e,t),getState:t=>i(e,t),getHistory:()=>(e=>t[e].history)(e),addMiddleWares:(...n)=>((e,...n)=>{let r=t[e].middleWares;return t[e].middleWares=[...r,...n],t[e].middleWares})(e,...n),subscribe:t=>a(e,t),unSubscribe:n=>((e,n)=>{t[e].subscribers.delete(n)})(e,n),notifySubscribers:e=>s(e),usePlugin:n=>((e,n)=>{const o=r[n]||null;o&&(t[e].activePlugins.push(o),(o.exposes||[]).forEach((n=>{t[e][n.name]=(...r)=>n.method(t[e].state,...r)})))})(e,n)},t[e]),removeChannel:e=>{if(t[e]){const n=Object.keys(t).filter((t=>t!==e)).reduce(((e,n)=>(e[n]=t[n],e)),{});t=n}return t}}}},A=T;class w extends HTMLElement{constructor(){super(...arguments),n(this,"_handleClick",(e=>{e.preventDefault();const t=this.getAttribute("to")||"/",n=this.getAttribute("target"),r=new CustomEvent("z-navigate",{bubbles:!0,detail:{path:t,target:n}});this.dispatchEvent(r)}))}connectedCallback(){this.addEventListener("click",this._handleClick),this.style.cursor="pointer"}disconnectedCallback(){this.removeEventListener("click",this._handleClick)}}function S(e={}){const t=e.parent||document.body,n=e.routes||[],o=e.initialDelay||0,i=(e,o={})=>{const i=o.target||t,a=(e=>{const t=e.startsWith("/")?e:`/${e}`;if(t.endsWith("/index.html"))return n.find((e=>"/"===e.route));const r=n.find((e=>e.route===t));return r||n.find((e=>"/*"===e.route))})(e),s=o.component||(null==a?void 0:a.component);if(s){let t=e.endsWith("/index.html")?"/":e;t=t.startsWith("/")?t:`/${t}`,o.replaceState?history.replaceState({},"",t):history.pushState({},"",t),r(i,s)}},a=e=>{const{path:t,target:n}=e.detail;if(s(e.target),n){const e=document.getElementById(n);e&&i(t,{target:e})}else i(t)},s=e=>{t.querySelectorAll("z-link").forEach((t=>{t.classList.toggle("active",t===e)}))},l=()=>{const e=window.location.pathname+window.location.search;i(e,{replaceState:!0})},c=()=>{0!==n.length&&(t.addEventListener("z-navigate",a),window.addEventListener("popstate",l),(()=>{const e=window.location.pathname+window.location.search;i(e,{replaceState:!0})})())};return o>0?setTimeout(c,o):"loading"===document.readyState?document.addEventListener("DOMContentLoaded",c):c(),{history:window.history,location:window.location,goTo:i,goBack:()=>window.history.back(),goForward:()=>window.history.forward(),getParam:e=>{const t=new URLSearchParams(window.location.search);return t.has(e)?t.get(e):null},reloadRouter:c}}customElements.get("z-link")||customElements.define("z-link",w);let L=null,M=null;e.css=function(e,...t){a||(a=document.createElement("style"),document.head.appendChild(a));const n=e.reduce(((e,n,r)=>e+n+(t[r]||"")),""),r="css-"+function(e){let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t.toString(36)}(n);if(i.has(r))return i.get(r);const o=`.${r} { ${n} }`;return a.innerHTML+=o,i.set(r,r),r},e.getRootElement=()=>M,e.html=function(e,...t){const n=[],r=[];E.clear();const i=e.reduce(((e,n,r)=>{if("function"==typeof t[r])return e+n+`__FUNCTION_${r}__`;if(t[r]instanceof HTMLElement){const i=t[r].getAttribute("_id")||o("ELEMENT");return t[r].setAttribute("_id",i),e+n+`<div _id="${i}"></div>`}return e+n+(void 0!==t[r]?"object"==typeof(i=t[r])&&i.hasOwnProperty("value")?(E.add(i),i.current()):i:"");var i}),"");return t.forEach(((e,t)=>{if("function"==typeof e)n.push({name:`__FUNCTION_${t}__`,fn:e});else if(e instanceof HTMLElement){const t=e.getAttribute("_id")||o("ELEMENT");e.setAttribute("_id",t),r.push({name:t,element:e})}})),N(C((new DOMParser).parseFromString(i,"text/html").body.firstChild,n,r),E)},e.reactive=function(e){const t=e();return E&&E.size>0&&E.forEach((t=>{t.subscribe((()=>{let n=document.querySelector(`[_id="${t.elementInDom}"]`),r=e();n&&function(e,t,n={}){const r={...n};y(e,t,r)}(n,r)}))})),t},e.render=(e=null,t=[],n=0)=>{if(!e)return;if(0===t.length)return;return r(e,t.find((e=>"/"===e.route)).component),e&&t.length>0&&(M=e,L=new S({routes:t,parent:e,initialDelay:n})),L},e.store=A,e.useEffect=function(e,t){0!==t.length?t.forEach((t=>{let n=A.getChannel(t.id);n&&n.subscribe(e)})):window.addEventListener("DOMContentLoaded",e())},e.useRouter=()=>L,e.useState=function(e){let t=o("state",12),n=T.addChannel(t,e);return[{id:t,current:()=>n.getState(),subscribe:e=>n.subscribe(e),value:n.getState()},n.setState,n]},e.useSuspense=function(e,t,n={}){const{retry:r=!1,retryDelay:o=1e3,maxRetries:i=3}=n;if(!(t instanceof HTMLElement))throw new Error("Fallback must be an HTML element");const a=document.createElement("div");a.appendChild(t);let s=0;const l=()=>{e().then((e=>{if(!(e instanceof HTMLElement))throw new Error("Suspense content must be a valid HTML element");a.innerHTML="",a.appendChild(e)})).catch((e=>{r&&s<i&&(s++,setTimeout(l,o))}))};return l(),a},Object.defineProperty(e,Symbol.toStringTag,{value:"Module"})}));
